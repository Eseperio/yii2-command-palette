{"version":3,"file":"palette.min.js","sources":["../../src/js/fuzzy.js","../../src/js/i18n.js","../../src/js/dom.js","../../src/js/logger.js","../../src/js/linkScraper.js","../../src/js/palette.js"],"sourcesContent":["/**\n * Fuzzy search algorithms for the command palette\n */\n\n/**\n * Returns the minimum Levenshtein distance between the query and any substring of 'text'\n * @param {string} query - The search query\n * @param {string} text - The text to search in\n * @returns {number} - The minimum Levenshtein distance\n */\nexport function fuzzyMinLevenshtein(query, text) {\n    if (!query || !text) return Infinity;\n    let minDist = Infinity;\n\n    // Search in all substrings of the same length as the query\n    for (let i = 0; i <= text.length - query.length; i++) {\n        const substr = text.substr(i, query.length);\n        minDist = Math.min(minDist, levenshtein(query, substr));\n    }\n\n    // Also compare with the full text (in case the query is longer than the text)\n    minDist = Math.min(minDist, levenshtein(query, text));\n\n    return minDist;\n}\n\n/**\n * Standard Levenshtein algorithm\n * @param {string} a - First string\n * @param {string} b - Second string\n * @returns {number} - The Levenshtein distance\n */\nexport function levenshtein(a, b) {\n    const m = a.length, n = b.length;\n\n    if (m === 0) return n;\n    if (n === 0) return m;\n\n    const dp = [];\n    for (let i = 0; i <= m; i++) dp[i] = [i];\n    for (let j = 1; j <= n; j++) dp[0][j] = j;\n\n    for (let i = 1; i <= m; i++) {\n        for (let j = 1; j <= n; j++) {\n            const cost = a[i - 1].toLowerCase() === b[j - 1].toLowerCase() ? 0 : 1;\n            dp[i][j] = Math.min(\n                dp[i - 1][j] + 1,\n                dp[i][j - 1] + 1,\n                dp[i - 1][j - 1] + cost\n            );\n        }\n    }\n\n    return dp[m][n];\n}\n\n/**\n * Filter items based on a search query using fuzzy search\n * @param {string} query - The search query\n * @param {Array} items - The items to filter\n * @returns {Array} - The filtered items\n */\nexport function filterItems(query, items) {\n    if (!query) return items.slice();\n\n    query = query.trim().toLowerCase();\n\n    // Solo coincidencias completas (substring) si <= 3 caracteres\n    let exactMatches =  items.filter(item => {\n        const name = item.name.toLowerCase();\n        const subtitle = item.subtitle ? item.subtitle.toLowerCase() : '';\n        return name.includes(query) || subtitle.includes(query);\n    });\n\n    if(exactMatches.length > 0) {\n        // Si hay coincidencias exactas y la consulta es corta, devolver solo esas\n        return exactMatches;\n    }\n\n    // BÃºsqueda difusa si > 3 caracteres\n    return items\n        .map(item => {\n            const name = item.name.toLowerCase();\n            const subtitle = item.subtitle ? item.subtitle.toLowerCase() : '';\n            const distName = fuzzyMinLevenshtein(query, name);\n            const distSubtitle = subtitle ? fuzzyMinLevenshtein(query, subtitle) : Infinity;\n            const score = Math.min(distName, distSubtitle);\n\n            const substringMatch = name.includes(query) || subtitle.includes(query);\n            return {...item, _score: score, _substringMatch: substringMatch};\n        })\n        .sort((a, b) => {\n            if (a._substringMatch && !b._substringMatch) return -1;\n            if (!a._substringMatch && b._substringMatch) return 1;\n            return a._score - b._score;\n        })\n        .filter(item =>\n            item._substringMatch ||\n            item._score <= 2\n        );\n}\n","/**\n * Internationalization for the command palette\n * Contains translations for the 10 most common languages\n */\n\nconst translations = {\n    // English\n    'en': {\n        'search': 'Search...',\n        'noResults': 'No results'\n    },\n    // Spanish\n    'es': {\n        'search': 'Buscar...',\n        'noResults': 'Sin resultados'\n    },\n    // French\n    'fr': {\n        'search': 'Rechercher...',\n        'noResults': 'Aucun rÃ©sultat'\n    },\n    // German\n    'de': {\n        'search': 'Suchen...',\n        'noResults': 'Keine Ergebnisse'\n    },\n    // Italian\n    'it': {\n        'search': 'Cerca...',\n        'noResults': 'Nessun risultato'\n    },\n    // Portuguese\n    'pt': {\n        'search': 'Pesquisar...',\n        'noResults': 'Sem resultados'\n    },\n    // Russian\n    'ru': {\n        'search': 'ÐŸÐ¾Ð¸ÑÐº...',\n        'noResults': 'ÐÐµÑ‚ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð²'\n    },\n    // Chinese (Simplified)\n    'zh': {\n        'search': 'æœç´¢...',\n        'noResults': 'æ²¡æœ‰ç»“æžœ'\n    },\n    // Japanese\n    'ja': {\n        'search': 'æ¤œç´¢...',\n        'noResults': 'çµæžœãªã—'\n    },\n    // Arabic\n    'ar': {\n        'search': 'Ø¨Ø­Ø«...',\n        'noResults': 'Ù„Ø§ Ù†ØªØ§Ø¦Ø¬'\n    }\n};\n\n/**\n * Get a translation for a key in the specified locale\n * @param {string} key - The translation key\n * @param {string} locale - The locale code\n * @returns {string} - The translated string or the key if no translation is found\n */\nexport function getTranslation(key, locale = 'en') {\n    // If the locale doesn't exist, fall back to English\n    if (!translations[locale]) {\n        locale = 'en';\n    }\n    \n    // If the key doesn't exist, return the key itself\n    return translations[locale][key] || key;\n}\n\n/**\n * Get all translations for a locale\n * @param {string} locale - The locale code\n * @returns {Object} - The translations object for the locale\n */\nexport function getTranslations(locale = 'en') {\n    // If the locale doesn't exist, fall back to English\n    return translations[locale] || translations['en'];\n}\n\nexport default {\n    getTranslation,\n    getTranslations\n};\n","/**\n * DOM handling helpers for the command palette\n */\n\nimport { getTranslation } from './i18n.js';\n\n/**\n * Get the URL type label for an action\n * @param {string|Function} action - The action to check\n * @returns {Object|null} - Object with type and color, or null if no label needed\n */\nfunction getUrlTypeLabel(action) {\n    if (typeof action !== 'string') {\n        return null;\n    }\n    \n    const lowerAction = action.toLowerCase();\n    \n    // Check for mailto\n    if (lowerAction.startsWith('mailto:')) {\n        return { type: 'email', color: '#f59e0b' }; // yellow/amber\n    }\n    \n    // Check for tel\n    if (lowerAction.startsWith('tel:')) {\n        return { type: 'phone', color: '#10b981' }; // green\n    }\n    \n    // Check for HTTP (unsecure)\n    if (lowerAction.startsWith('http://')) {\n        return { type: 'unsecure', color: '#ef4444' }; // red - only for HTTP\n    }\n\n// Check for other common protocols (show in blue)\n// Common protocols: ftp, sms, spotify, steam, slack, etc.\n    const protoMatch = lowerAction.match(/^(ftp|ftps|sms|spotify|steam|slack|discord|zoom|teams|whatsapp):/);\n    if (protoMatch) {\n        return { type: protoMatch[1], color: '#3b82f6' };\n    }\n\n    return null;\n}\n\n/**\n * Renders a list of items in the command palette\n * @param {HTMLElement} listElement - The list element to render items in\n * @param {Array} items - The items to render\n * @param {number} selectedIdx - The index of the selected item\n * @param {string} locale - The locale for translations\n * @returns {void}\n */\nexport function renderList(listElement, items, selectedIdx = 0, locale = 'en') {\n    // Store the previously selected item index\n    const prevSelectedIdx = listElement.getAttribute('data-selected-idx');\n    \n    // Get the current items count from the list\n    const currentItemsCount = listElement.querySelectorAll('.cmdk-item').length;\n    \n    // If this is just a selection change and the list is already populated with the same number of items\n    // This ensures we do a full redraw when search results change (different number of items)\n    if (listElement.children.length > 0 && items.length > 0 && \n        items.length === currentItemsCount && prevSelectedIdx !== null) {\n        // Update only the selection state\n        const prevSelected = listElement.querySelector(`.cmdk-item[data-idx=\"${prevSelectedIdx}\"]`);\n        const newSelected = listElement.querySelector(`.cmdk-item[data-idx=\"${selectedIdx}\"]`);\n        \n        if (prevSelected) {\n            prevSelected.classList.remove('selected');\n        }\n        \n        if (newSelected) {\n            newSelected.classList.add('selected');\n            // Update the stored selected index\n            listElement.setAttribute('data-selected-idx', selectedIdx);\n            return;\n        }\n    }\n    \n    // If we need to do a full render (first render or items changed)\n    listElement.innerHTML = '';\n    \n    if (items.length === 0) {\n        const noResultsText = getTranslation('noResults', locale);\n        listElement.innerHTML = `<li style=\"padding: 16px; color: #8b8b93;\">${noResultsText}</li>`;\n        return;\n    }\n    \n    // Get the template ID from the list element ID\n    const id = listElement.id.replace('cmdkList-', '');\n    const templateElement = document.getElementById(`cmdkItemTemplate-${id}`);\n    \n    if (!templateElement) {\n        console.error(`Template element not found: cmdkItemTemplate-${id}`);\n        return;\n    }\n    \n    const templateContent = templateElement.innerHTML;\n    \n    // Create a document fragment to improve performance\n    const fragment = document.createDocumentFragment();\n    \n    items.forEach((item, idx) => {\n        // Handle separator items\n        if (item._isSeparator) {\n            const separator = document.createElement('li');\n            separator.className = 'cmdk-separator';\n            separator.innerHTML = '<hr style=\"border: none; border-top: 1px solid #e5e5e5; margin: 8px 0;\">';\n            fragment.appendChild(separator);\n            return;\n        }\n        \n        // Create a new item from the template\n        let itemHtml = templateContent;\n        \n        // Replace placeholders with actual values\n        itemHtml = itemHtml.replace(/{{idx}}/g, idx);\n        \n        // Get URL type label if applicable\n        const urlLabel = getUrlTypeLabel(item.action);\n        let nameWithLabel = item.name || '';\n        if (urlLabel) {\n            const labelHtml = `<span style=\"display: inline-block; padding: 2px 6px; margin-right: 6px; font-size: 10px; font-weight: bold; color: white; background-color: ${urlLabel.color}; border-radius: 3px; text-transform: uppercase;\">${urlLabel.type}</span>`;\n            nameWithLabel = labelHtml + nameWithLabel;\n        }\n        itemHtml = itemHtml.replace(/{{name}}/g, nameWithLabel);\n        \n        // Handle icon\n        if (item.icon) {\n            // Get the widget ID from the list element ID\n            const widgetId = listElement.id.replace('cmdkList-', '');\n            // Check if HTML icons are allowed for this widget\n            const allowHtmlIcons = window[`cmdkAllowHtmlIcons_${widgetId}`] || false;\n            \n            // Check if the icon is a URL\n            if (typeof item.icon === 'string' && item.icon.match(/^https?:\\/\\//)) {\n                // Replace the icon placeholder with an img tag\n                itemHtml = itemHtml.replace(/{{#icon}}([\\s\\S]*?){{\\/icon}}/g, \n                    `<img src=\"${item.icon}\" class=\"cmdk-icon\" style=\"width: 22px; height: 22px; object-fit: cover;\">`);\n            } else if (allowHtmlIcons) {\n                // If HTML icons are allowed, use the icon content as HTML\n                // Replace the icon placeholder with the HTML content\n                itemHtml = itemHtml.replace(/{{#icon}}([\\s\\S]*?){{\\/icon}}/g, \n                    item.icon);\n            } else {\n                // Replace the icon content (treat as text)\n                itemHtml = itemHtml.replace(/{{icon}}/g, item.icon);\n                // Keep the icon block\n                itemHtml = itemHtml.replace(/{{#icon}}([\\s\\S]*?){{\\/icon}}/g, '$1');\n            }\n        } else {\n            // Remove the icon block\n            itemHtml = itemHtml.replace(/{{#icon}}[\\s\\S]*?{{\\/icon}}/g, '');\n        }\n        \n        // Handle subtitle\n        if (item.subtitle) {\n            itemHtml = itemHtml.replace(/{{subtitle}}/g, item.subtitle);\n            itemHtml = itemHtml.replace(/{{#subtitle}}([\\s\\S]*?){{\\/subtitle}}/g, '$1');\n        } else {\n            itemHtml = itemHtml.replace(/{{#subtitle}}[\\s\\S]*?{{\\/subtitle}}/g, '');\n        }\n        \n        // Create a temporary element to hold the HTML\n        const temp = document.createElement('div');\n        temp.innerHTML = itemHtml;\n        const li = temp.firstElementChild;\n        \n        // Add selected class if this is the selected item\n        if (idx === selectedIdx) {\n            li.classList.add('selected');\n        }\n        \n        fragment.appendChild(li);\n    });\n    \n    // Append all items at once\n    listElement.appendChild(fragment);\n    \n    // Store the selected index as a data attribute\n    listElement.setAttribute('data-selected-idx', selectedIdx);\n}\n\n/**\n * Scrolls to the selected item in the list\n * @param {HTMLElement} listElement - The list element\n * @returns {void}\n */\nexport function scrollToSelected(listElement) {\n    const selected = listElement.querySelector('.cmdk-item.selected');\n    if (selected) {\n        selected.scrollIntoView({ block: 'nearest' });\n    }\n}\n\n/**\n * Executes the action of an item\n * @param {Object} item - The item to execute\n * @param {boolean} openInNewTab - Whether to open the link in a new tab (Ctrl/Cmd+Enter)\n * @returns {void}\n */\nexport function executeItemAction(item, openInNewTab = false) {\n    if (!item) return;\n\n    if (typeof item.action === 'function') {\n        item.action();\n    } else if (typeof item.action === 'string') {\n        if (/^#/.test(item.action)) {\n            window.location.hash = item.action;\n        } else {\n            // If Ctrl/Cmd was pressed, open in new tab\n            if (openInNewTab) {\n                window.open(item.action, '_blank');\n            } else {\n                window.location.href = item.action;\n            }\n        }\n    }\n}\n\n/**\n * Adds event listeners to the command palette elements\n * @param {Object} elements - The command palette elements\n * @param {Object} callbacks - The callbacks for the events\n * @returns {void}\n */\nexport function setupEventListeners(elements, callbacks) {\n    const { overlay, panel, search, list } = elements;\n    const { onSearch, onKeyDown, onItemClick, onOverlayClick, onPanelBlur, onFocusIn } = callbacks;\n    \n    // Search input events\n    if (search && onSearch) {\n        search.addEventListener('input', onSearch);\n    }\n    \n    if (search && onKeyDown) {\n        search.addEventListener('keydown', onKeyDown);\n    }\n    \n    // List events\n    if (list && onItemClick) {\n        list.addEventListener('click', (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            const item = e.target.closest('.cmdk-item');\n            if (item) {\n                const idx = parseInt(item.getAttribute('data-idx'), 10);\n                onItemClick(idx);\n            }\n        });\n    }\n    \n    // Mouse movement on list items\n    if (list) {\n        list.addEventListener('mousemove', (e) => {\n            const item = e.target.closest('.cmdk-item');\n            if (item) {\n                const idx = parseInt(item.getAttribute('data-idx'), 10);\n                if (callbacks.onItemHover) {\n                    callbacks.onItemHover(idx);\n                }\n            }\n        });\n    }\n    \n    // Overlay click\n    if (overlay && onOverlayClick) {\n        overlay.addEventListener('click', onOverlayClick);\n    }\n    \n    // Panel blur\n    if (panel && onPanelBlur) {\n        panel.addEventListener('blur', onPanelBlur, true);\n    }\n    \n    // Document focus\n    if (onFocusIn) {\n        document.addEventListener('focusin', onFocusIn);\n    }\n    \n    // Global keyboard shortcuts\n    if (callbacks.onGlobalKeyDown) {\n        window.addEventListener('keydown', callbacks.onGlobalKeyDown);\n    }\n}\n","/**\n * Logger class for Command Palette\n * Provides consistent logging with debug mode control\n */\nclass Logger {\n    /**\n     * Constructor\n     * @param {boolean} debug - Whether debug mode is enabled\n     * @param {string} prefix - Prefix for all log messages\n     */\n    constructor(debug = false, prefix = '[CommandPalette]') {\n        this.debug = debug;\n        this.prefix = prefix;\n        \n        // Show initialization message if debug is enabled\n        if (this.debug) {\n            console.log(\n                '%c' + this.prefix + ' Debug mode is ENABLED',\n                'color: red; font-weight: bold;'\n            );\n        }\n    }\n    \n    /**\n     * Log a message to console if debug is enabled\n     * @param {...any} args - Arguments to pass to console.log\n     */\n    log(...args) {\n        if (this.debug) {\n            console.log(this.prefix, ...args);\n        }\n    }\n    \n    /**\n     * Log a warning to console if debug is enabled\n     * @param {...any} args - Arguments to pass to console.warn\n     */\n    warn(...args) {\n        if (this.debug) {\n            console.warn(this.prefix, ...args);\n        }\n    }\n    \n    /**\n     * Log an error to console if debug is enabled\n     * @param {...any} args - Arguments to pass to console.error\n     */\n    error(...args) {\n        if (this.debug) {\n            console.error(this.prefix, ...args);\n        }\n    }\n    \n    /**\n     * Log an info message to console if debug is enabled\n     * @param {...any} args - Arguments to pass to console.info\n     */\n    info(...args) {\n        if (this.debug) {\n            console.info(this.prefix, ...args);\n        }\n    }\n}\n\nexport default Logger;\n","/**\n * Link scraper module for the command palette\n * Scrapes all visible links from the page and converts them to command palette items\n */\n\n/**\n * Scrapes links from the page and returns them as command palette items\n * @param {Array} existingItems - Existing command palette items to avoid duplicates\n * @param {Array} excludeSelectors - CSS selectors for elements to exclude from scraping\n * @param {Object} logger - Logger instance for debug messages\n * @returns {Array} Array of command palette items created from scraped links\n */\nexport function scrapeLinks(existingItems = [], excludeSelectors = [], logger = null) {\n    const scrapedItems = [];\n    const existingUrls = new Set();\n    let skippedCount = 0;\n    \n    // Build a set of existing URLs to avoid duplicates\n    existingItems.forEach(item => {\n        if (typeof item.action === 'string') {\n            existingUrls.add(item.action);\n        }\n    });\n    \n    // Get all links on the page\n    const allLinks = document.querySelectorAll('a[href]');\n    \n    allLinks.forEach(link => {\n        // Skip if link is inside an excluded element\n        if (shouldExcludeLink(link, excludeSelectors)) {\n            if (logger) {\n                logger.log('Link skipped (in excluded element):', link.href);\n            }\n            skippedCount++;\n            return;\n        }\n        \n        const href = link.href;\n        \n        // Skip if URL already exists\n        if (existingUrls.has(href)) {\n            if (logger) {\n                logger.log('Link skipped (duplicate):', href);\n            }\n            skippedCount++;\n            return;\n        }\n        \n        // Get link text\n        let text = getLinkText(link);\n        \n        // Skip if no text is available\n        if (!text) {\n            if (logger) {\n                logger.log('Link skipped (no text):', href);\n            }\n            skippedCount++;\n            return;\n        }\n        \n        // Get heading from parent elements\n        const heading = getParentHeading(link);\n        \n        // Create command palette item\n        const item = {\n            icon: 'ðŸ”—', // Default link icon\n            name: text.trim(),\n            subtitle: heading || href, // Use heading as subtitle if found, otherwise use URL\n            action: href\n        };\n        \n        scrapedItems.push(item);\n        existingUrls.add(href);\n    });\n    \n    if (logger) {\n        logger.log('Links scraper found', scrapedItems.length, 'links', \n                   '(skipped', skippedCount, ')');\n    }\n    \n    return scrapedItems;\n}\n\n/**\n * Gets the text content of a link\n * @param {HTMLElement} link - The link element\n * @returns {string|null} The text content or null if not available\n */\nfunction getLinkText(link) {\n    // Try to get direct text content\n    let text = link.textContent.trim();\n    \n    // If no text, try title attribute\n    if (!text && link.hasAttribute('title')) {\n        text = link.getAttribute('title').trim();\n    }\n    \n    // If no text, try aria-label\n    if (!text && link.hasAttribute('aria-label')) {\n        text = link.getAttribute('aria-label').trim();\n    }\n    \n    return text || null;\n}\n\n/**\n * Searches for a heading element in parent elements\n * @param {HTMLElement} link - The link element\n * @returns {string|null} The text content of the first heading found, or null\n */\nfunction getParentHeading(link) {\n    // Traverse up the DOM tree looking for heading elements\n    let currentElement = link.parentElement;\n    \n    while (currentElement && currentElement !== document.body) {\n        // Check if current element has a heading child that comes before the link\n        const headings = currentElement.querySelectorAll('h1, h2, h3, h4, h5, h6');\n        \n        for (const heading of headings) {\n            // Check if the heading appears before the link in the DOM\n            if (currentElement.contains(heading) && currentElement.contains(link)) {\n                // Make sure the heading is not the link itself or inside the link\n                if (!link.contains(heading) && heading !== link) {\n                    const headingText = heading.textContent.trim();\n                    if (headingText) {\n                        return headingText;\n                    }\n                }\n            }\n        }\n        \n        currentElement = currentElement.parentElement;\n    }\n    \n    return null;\n}\n\n/**\n * Checks if a link should be excluded based on the exclude selectors\n * @param {HTMLElement} link - The link element to check\n * @param {Array} excludeSelectors - CSS selectors for elements to exclude\n * @returns {boolean} True if the link should be excluded\n */\nfunction shouldExcludeLink(link, excludeSelectors) {\n    if (!excludeSelectors || excludeSelectors.length === 0) {\n        return false;\n    }\n    \n    // Check if link or any of its parents match any exclude selector\n    for (const selector of excludeSelectors) {\n        try {\n            if (link.matches(selector) || link.closest(selector)) {\n                return true;\n            }\n        } catch (e) {\n            console.error('Invalid exclude selector:', selector, e);\n        }\n    }\n    \n    return false;\n}\n","/**\n * Main palette logic for the command palette\n */\n\nimport { filterItems } from './fuzzy.js';\nimport { renderList, scrollToSelected, executeItemAction, setupEventListeners } from './dom.js';\nimport { getTranslation, getTranslations } from './i18n.js';\nimport Logger from './logger.js';\nimport { scrapeLinks } from './linkScraper.js';\n\n// Import SCSS for Vite to process\nimport '../scss/palette.scss';\n\n/**\n * Command Palette class\n */\nclass CommandPalette {\n    /**\n     * Constructor\n     * @param {string} id - The ID of the command palette\n     * @param {Array} items - The items to display in the command palette\n     * @param {Object} settings - Configuration object\n     * @param {string} settings.locale - The locale for translations (default: 'en')\n     * @param {boolean} settings.debug - Whether debug mode is enabled (default: false)\n     * @param {boolean} settings.enableLinksScraper - Whether to enable links scraper (default: false)\n     * @param {Array} settings.linkScraperExcludeSelectors - CSS selectors to exclude from link scraping (default: [])\n     * @param {number} settings.maxRecentItems - Maximum number of recent items to keep (0 to disable) (default: 0)\n     */\n    constructor(id, items = [], settings = {}) {\n        this.id = id;\n\n        // Destructure settings with defaults\n        const {\n            locale = 'en',\n            debug = false,\n            enableLinksScraper = false,\n            linkScraperExcludeSelectors = [],\n            maxRecentItems = 0\n        } = settings;\n\n        this.enableLinksScraper = enableLinksScraper;\n        this.linkScraperExcludeSelectors = linkScraperExcludeSelectors;\n\n        // Initialize logger first\n        this.logger = new Logger(debug);\n\n        // Scrape links if enabled\n        if (this.enableLinksScraper) {\n            const scrapedLinks = scrapeLinks(items, this.linkScraperExcludeSelectors, this.logger);\n            this.items = [...items, ...scrapedLinks];\n        } else {\n            this.items = items;\n        }\n\n        this.filtered = [...this.items];\n        this.selectedIdx = 0;\n        this.isOpen = false;\n        this.locale = locale;\n        this.debug = debug;\n        this.maxRecentItems = maxRecentItems;\n\n        // Track Ctrl/Cmd key state for new tab shortcuts\n        this.ctrlKeyPressed = false;\n        \n        this.logger.log('Initializing command palette with', this.items.length, 'items');\n        this.logger.log('Recent items:', maxRecentItems > 0 ? `enabled (max: ${maxRecentItems})` : 'disabled');\n        // Get DOM elements\n        this.elements = {\n            overlay: document.getElementById(`cmdkOverlay-${id}`),\n            panel: document.getElementById(`cmdkPanel-${id}`),\n            search: document.getElementById(`cmdkSearch-${id}`),\n            list: document.getElementById(`cmdkList-${id}`)\n        };\n        \n        // Set placeholder text based on locale\n        if (this.elements.search) {\n            this.elements.search.placeholder = getTranslation('search', this.locale);\n        }\n        \n        // Initialize\n        this.init();\n    }\n    \n    /**\n     * Initialize the command palette\n     * @returns {void}\n     */\n    init() {\n        // Set up event listeners\n        setupEventListeners(this.elements, {\n            onSearch: this.handleSearch.bind(this),\n            onKeyDown: this.handleKeyDown.bind(this),\n            onItemClick: this.selectItem.bind(this),\n            onItemHover: this.handleItemHover.bind(this),\n            onOverlayClick: this.close.bind(this),\n            onPanelBlur: this.handlePanelBlur.bind(this),\n            onFocusIn: this.handleFocusIn.bind(this),\n            onGlobalKeyDown: this.handleGlobalKeyDown.bind(this)\n        });\n        \n        // Track Ctrl/Cmd key state globally\n        document.addEventListener('keydown', (e) => {\n            if (e.key === 'Control' || e.key === 'Meta') {\n                this.ctrlKeyPressed = true;\n                this.logger.log('Ctrl/Cmd key pressed');\n            }\n        });\n        \n        document.addEventListener('keyup', (e) => {\n            if (e.key === 'Control' || e.key === 'Meta') {\n                this.ctrlKeyPressed = false;\n                this.logger.log('Ctrl/Cmd key released');\n            }\n        });\n        \n        // Initial render\n        renderList(this.elements.list, this.filtered, this.selectedIdx, this.locale);\n    }\n    \n    /**\n     * Get the localStorage key for recent items\n     * @returns {string} - The localStorage key\n     */\n    getRecentItemsKey() {\n        return `cmdPalette_recentItems_${this.id}`;\n    }\n\n    /**\n     * Get recent items from localStorage\n     * @returns {Array} - Array of recent items\n     */\n    getRecentItems() {\n        if (this.maxRecentItems === 0) {\n            return [];\n        }\n\n        try {\n            const stored = localStorage.getItem(this.getRecentItemsKey());\n            if (!stored) {\n                return [];\n            }\n\n            const items = JSON.parse(stored);\n            this.logger.log('Retrieved', items.length, 'recent items from localStorage');\n            return Array.isArray(items) ? items : [];\n        } catch (e) {\n            this.logger.error('Error loading recent items from localStorage:', e);\n            return [];\n        }\n    }\n\n    /**\n     * Add an item to recent items\n     * @param {Object} item - The item to add\n     * @returns {void}\n     */\n    addRecentItem(item) {\n        if (this.maxRecentItems === 0) {\n            return;\n        }\n\n        try {\n            let recentItems = this.getRecentItems();\n\n            // Remove the item if it already exists (to move it to the front)\n            recentItems = recentItems.filter(recentItem => {\n                // Compare by name and action as a simple way to detect duplicates\n                return !(recentItem.name === item.name && recentItem.action === item.action);\n            });\n\n            // Add the item to the front\n            recentItems.unshift(item);\n\n            // Limit to maxRecentItems\n            if (recentItems.length > this.maxRecentItems) {\n                recentItems = recentItems.slice(0, this.maxRecentItems);\n            }\n\n            // Save to localStorage\n            localStorage.setItem(this.getRecentItemsKey(), JSON.stringify(recentItems));\n            this.logger.log('Added item to recent items:', item.name);\n        } catch (e) {\n            this.logger.error('Error saving recent item to localStorage:', e);\n        }\n    }\n\n    /**\n     * Merge recent items with regular items, removing duplicates\n     * @param {Array} recentItems - The recent items\n     * @param {Array} regularItems - The regular items\n     * @returns {Array} - Array with recent items first, then a separator, then regular items (no duplicates)\n     */\n    mergeItemsWithRecent(recentItems, regularItems) {\n        if (recentItems.length === 0) {\n            return regularItems;\n        }\n\n        // Filter out duplicates from regular items\n        const filteredRegular = regularItems.filter(regularItem => {\n            return !recentItems.some(recentItem =>\n                recentItem.name === regularItem.name && recentItem.action === regularItem.action\n            );\n        });\n\n        // If there are no regular items after filtering, just return recent items\n        if (filteredRegular.length === 0) {\n            return recentItems;\n        }\n\n        // Add a separator between recent and regular items\n        const separator = {\n            _isSeparator: true,\n            name: '',\n            action: null\n        };\n\n        return [...recentItems, separator, ...filteredRegular];\n    }\n\n    /**\n     * Open the command palette\n     * @returns {void}\n     */\n    open() {\n        if (this.isOpen) return;\n        \n        this.logger.log('Opening command palette');\n        \n        this.isOpen = true;\n        this.elements.overlay.style.display = 'block';\n        this.elements.panel.style.display = 'flex';\n        \n        setTimeout(() => this.elements.search.focus(), 20);\n        \n        this.elements.search.value = '';\n\n        // Merge recent items with regular items\n        const recentItems = this.getRecentItems();\n        this.filtered = this.mergeItemsWithRecent(recentItems, this.items);\n\n        // Set selectedIdx to first non-separator item\n        this.selectedIdx = 0;\n        while (this.filtered[this.selectedIdx] && this.filtered[this.selectedIdx]._isSeparator) {\n            this.selectedIdx++;\n        }\n\n        renderList(this.elements.list, this.filtered, this.selectedIdx, this.locale);\n    }\n    \n    /**\n     * Close the command palette\n     * @returns {void}\n     */\n    close() {\n        this.logger.log('Closing command palette');\n        this.isOpen = false;\n        this.elements.overlay.style.display = 'none';\n        this.elements.panel.style.display = 'none';\n    }\n    \n    /**\n     * Handle search input\n     * @param {Event} e - The input event\n     * @returns {void}\n     */\n    handleSearch(e) {\n        const query = e.target.value.trim();\n\n        if (!query) {\n            // If search is empty, show items with recent items merged\n            const recentItems = this.getRecentItems();\n            this.filtered = this.mergeItemsWithRecent(recentItems, this.items);\n        } else {\n            // When searching, we need to search in both recent and regular items\n            // but prevent duplicates\n            const recentItems = this.getRecentItems();\n            const allItems = this.mergeItemsWithRecent(recentItems, this.items);\n\n            // Filter all items (excluding separator)\n            this.filtered = filterItems(query, allItems.filter(item => !item._isSeparator));\n        }\n\n        // Set selectedIdx to first non-separator item\n        this.selectedIdx = 0;\n        while (this.filtered[this.selectedIdx] && this.filtered[this.selectedIdx]._isSeparator) {\n            this.selectedIdx++;\n        }\n\n        renderList(this.elements.list, this.filtered, this.selectedIdx, this.locale);\n    }\n    \n    /**\n     * Handle key down events\n     * @param {KeyboardEvent} e - The keyboard event\n     * @returns {void}\n     */\n    handleKeyDown(e) {\n        if (e.key === 'ArrowDown') {\n            e.preventDefault();\n            let newIdx = (this.selectedIdx + 1) % this.filtered.length;\n            // Skip separators\n            while (this.filtered[newIdx] && this.filtered[newIdx]._isSeparator) {\n                newIdx = (newIdx + 1) % this.filtered.length;\n            }\n            this.selectedIdx = newIdx;\n            renderList(this.elements.list, this.filtered, this.selectedIdx, this.locale);\n            scrollToSelected(this.elements.list);\n        } else if (e.key === 'ArrowUp') {\n            e.preventDefault();\n            let newIdx = (this.selectedIdx - 1 + this.filtered.length) % this.filtered.length;\n            // Skip separators\n            while (this.filtered[newIdx] && this.filtered[newIdx]._isSeparator) {\n                newIdx = (newIdx - 1 + this.filtered.length) % this.filtered.length;\n            }\n            this.selectedIdx = newIdx;\n            renderList(this.elements.list, this.filtered, this.selectedIdx, this.locale);\n            scrollToSelected(this.elements.list);\n        } else if (e.key === 'Enter') {\n            e.preventDefault();\n            this.selectItem(this.selectedIdx);\n        } else if (e.key === 'Escape') {\n            this.close();\n        }\n    }\n    \n    /**\n     * Handle global key down events\n     * @param {KeyboardEvent} e - The keyboard event\n     * @returns {void}\n     */\n    handleGlobalKeyDown(e) {\n        if ((e.metaKey || e.ctrlKey) && e.key.toLowerCase() === 'k') {\n            e.preventDefault();\n            this.open();\n        }\n        \n        if (this.isOpen && e.key === 'Escape') {\n            this.close();\n        }\n    }\n    \n    /**\n     * Handle panel blur events\n     * @param {FocusEvent} e - The focus event\n     * @returns {void}\n     */\n    handlePanelBlur(e) {\n        // Espera brevemente antes de cerrar, para permitir que el click procese la acciÃ³n\n        setTimeout(() => {\n            if (!this.elements.panel.contains(document.activeElement)) {\n                this.close();\n            }\n        }, 10);\n    }\n    \n    /**\n     * Handle focus in events\n     * @param {FocusEvent} e - The focus event\n     * @returns {void}\n     */\n    handleFocusIn(e) {\n        if (this.isOpen && !this.elements.panel.contains(e.target)) {\n            this.close();\n        }\n    }\n    \n    /**\n     * Handle item hover events\n     * @param {number} idx - The index of the hovered item\n     * @returns {void}\n     */\n    handleItemHover(idx) {\n        if (idx !== this.selectedIdx) {\n            this.selectedIdx = idx;\n            renderList(this.elements.list, this.filtered, this.selectedIdx, this.locale);\n        }\n    }\n    \n    /**\n     * Select an item\n     * @param {number} idx - The index of the item to select\n     * @returns {void}\n     */\n    selectItem(idx) {\n        const item = this.filtered[idx];\n        if (!item || item._isSeparator) return;\n        \n        this.logger.log('Item selected:', item.name, 'Ctrl/Cmd pressed:', this.ctrlKeyPressed);\n\n        // Add to recent items before executing action\n        this.addRecentItem(item);\n\n        executeItemAction(item, this.ctrlKeyPressed); // Pass Ctrl key state\n        this.close();            // Luego cierra el panel\n    }\n}\n\n// Export the CommandPalette class\nexport default CommandPalette;\n\n// Make it available globally\nwindow.CommandPalette = CommandPalette;\n"],"names":["fuzzyMinLevenshtein","query","text","minDist","i","substr","levenshtein","a","b","m","dp","j","cost","filterItems","items","exactMatches","item","name","subtitle","distName","distSubtitle","score","substringMatch","translations","getTranslation","key","locale","getUrlTypeLabel","action","lowerAction","protoMatch","renderList","listElement","selectedIdx","prevSelectedIdx","currentItemsCount","prevSelected","newSelected","noResultsText","id","templateElement","templateContent","fragment","idx","separator","itemHtml","urlLabel","nameWithLabel","widgetId","allowHtmlIcons","temp","li","scrollToSelected","selected","executeItemAction","openInNewTab","setupEventListeners","elements","callbacks","overlay","panel","search","list","onSearch","onKeyDown","onItemClick","onOverlayClick","onPanelBlur","onFocusIn","e","Logger","debug","prefix","args","scrapeLinks","existingItems","excludeSelectors","logger","scrapedItems","existingUrls","skippedCount","link","shouldExcludeLink","href","getLinkText","heading","getParentHeading","currentElement","headings","headingText","selector","CommandPalette","settings","enableLinksScraper","linkScraperExcludeSelectors","maxRecentItems","scrapedLinks","stored","recentItems","recentItem","regularItems","filteredRegular","regularItem","allItems","newIdx"],"mappings":"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"}