{"version":3,"file":"palette.min.js","sources":["../../src/js/fuzzy.js","../../src/js/i18n.js","../../src/js/dom.js","../../src/js/logger.js","../../src/js/external-search.js","../../src/js/palette.js"],"sourcesContent":["/**\n * Fuzzy search algorithms for the command palette\n */\n\n/**\n * Returns the minimum Levenshtein distance between the query and any substring of 'text'\n * @param {string} query - The search query\n * @param {string} text - The text to search in\n * @returns {number} - The minimum Levenshtein distance\n */\nexport function fuzzyMinLevenshtein(query, text) {\n    if (!query || !text) return Infinity;\n    let minDist = Infinity;\n\n    // Search in all substrings of the same length as the query\n    for (let i = 0; i <= text.length - query.length; i++) {\n        const substr = text.substr(i, query.length);\n        minDist = Math.min(minDist, levenshtein(query, substr));\n    }\n\n    // Also compare with the full text (in case the query is longer than the text)\n    minDist = Math.min(minDist, levenshtein(query, text));\n\n    return minDist;\n}\n\n/**\n * Standard Levenshtein algorithm\n * @param {string} a - First string\n * @param {string} b - Second string\n * @returns {number} - The Levenshtein distance\n */\nexport function levenshtein(a, b) {\n    const m = a.length, n = b.length;\n\n    if (m === 0) return n;\n    if (n === 0) return m;\n\n    const dp = [];\n    for (let i = 0; i <= m; i++) dp[i] = [i];\n    for (let j = 1; j <= n; j++) dp[0][j] = j;\n\n    for (let i = 1; i <= m; i++) {\n        for (let j = 1; j <= n; j++) {\n            const cost = a[i - 1].toLowerCase() === b[j - 1].toLowerCase() ? 0 : 1;\n            dp[i][j] = Math.min(\n                dp[i - 1][j] + 1,\n                dp[i][j - 1] + 1,\n                dp[i - 1][j - 1] + cost\n            );\n        }\n    }\n\n    return dp[m][n];\n}\n\n/**\n * Filter items based on a search query using fuzzy search\n * @param {string} query - The search query\n * @param {Array} items - The items to filter\n * @returns {Array} - The filtered items\n */\nexport function filterItems(query, items) {\n    if (!query) return items.slice();\n\n    query = query.trim().toLowerCase();\n\n    // Solo coincidencias completas (substring) si <= 3 caracteres\n    let exactMatches =  items.filter(item => {\n        const name = item.name.toLowerCase();\n        const subtitle = item.subtitle ? item.subtitle.toLowerCase() : '';\n        return name.includes(query) || subtitle.includes(query);\n    });\n\n    if(exactMatches.length > 0) {\n        // Si hay coincidencias exactas y la consulta es corta, devolver solo esas\n        return exactMatches;\n    }\n\n    // B√∫squeda difusa si > 3 caracteres\n    return items\n        .map(item => {\n            const name = item.name.toLowerCase();\n            const subtitle = item.subtitle ? item.subtitle.toLowerCase() : '';\n            const distName = fuzzyMinLevenshtein(query, name);\n            const distSubtitle = subtitle ? fuzzyMinLevenshtein(query, subtitle) : Infinity;\n            const score = Math.min(distName, distSubtitle);\n\n            const substringMatch = name.includes(query) || subtitle.includes(query);\n            return {...item, _score: score, _substringMatch: substringMatch};\n        })\n        .sort((a, b) => {\n            if (a._substringMatch && !b._substringMatch) return -1;\n            if (!a._substringMatch && b._substringMatch) return 1;\n            return a._score - b._score;\n        })\n        .filter(item =>\n            item._substringMatch ||\n            item._score <= 2\n        );\n}\n","/**\n * Internationalization for the command palette\n * Contains translations for the 10 most common languages\n */\n\nconst translations = {\n    // English\n    'en': {\n        'search': 'Search...',\n        'noResults': 'No results'\n    },\n    // Spanish\n    'es': {\n        'search': 'Buscar...',\n        'noResults': 'Sin resultados'\n    },\n    // French\n    'fr': {\n        'search': 'Rechercher...',\n        'noResults': 'Aucun r√©sultat'\n    },\n    // German\n    'de': {\n        'search': 'Suchen...',\n        'noResults': 'Keine Ergebnisse'\n    },\n    // Italian\n    'it': {\n        'search': 'Cerca...',\n        'noResults': 'Nessun risultato'\n    },\n    // Portuguese\n    'pt': {\n        'search': 'Pesquisar...',\n        'noResults': 'Sem resultados'\n    },\n    // Russian\n    'ru': {\n        'search': '–ü–æ–∏—Å–∫...',\n        'noResults': '–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤'\n    },\n    // Chinese (Simplified)\n    'zh': {\n        'search': 'ÊêúÁ¥¢...',\n        'noResults': 'Ê≤°ÊúâÁªìÊûú'\n    },\n    // Japanese\n    'ja': {\n        'search': 'Ê§úÁ¥¢...',\n        'noResults': 'ÁµêÊûú„Å™„Åó'\n    },\n    // Arabic\n    'ar': {\n        'search': 'ÿ®ÿ≠ÿ´...',\n        'noResults': 'ŸÑÿß ŸÜÿ™ÿßÿ¶ÿ¨'\n    }\n};\n\n/**\n * Get a translation for a key in the specified locale\n * @param {string} key - The translation key\n * @param {string} locale - The locale code\n * @returns {string} - The translated string or the key if no translation is found\n */\nexport function getTranslation(key, locale = 'en') {\n    // If the locale doesn't exist, fall back to English\n    if (!translations[locale]) {\n        locale = 'en';\n    }\n    \n    // If the key doesn't exist, return the key itself\n    return translations[locale][key] || key;\n}\n\n/**\n * Get all translations for a locale\n * @param {string} locale - The locale code\n * @returns {Object} - The translations object for the locale\n */\nexport function getTranslations(locale = 'en') {\n    // If the locale doesn't exist, fall back to English\n    return translations[locale] || translations['en'];\n}\n\nexport default {\n    getTranslation,\n    getTranslations\n};\n","/**\n * DOM handling helpers for the command palette\n */\n\nimport { getTranslation } from './i18n.js';\n\n/**\n * Get the URL type label for an action\n * @param {string|Function} action - The action to check\n * @returns {Object|null} - Object with type and color, or null if no label needed\n */\nfunction getUrlTypeLabel(action) {\n    if (typeof action !== 'string') {\n        return null;\n    }\n    \n    const lowerAction = action.toLowerCase();\n    \n    // Check for mailto\n    if (lowerAction.startsWith('mailto:')) {\n        return { type: 'email', color: '#f59e0b' }; // yellow/amber\n    }\n    \n    // Check for tel\n    if (lowerAction.startsWith('tel:')) {\n        return { type: 'phone', color: '#10b981' }; // green\n    }\n    \n    // Check for HTTP (unsecure)\n    if (lowerAction.startsWith('http://')) {\n        return { type: 'unsecure', color: '#ef4444' }; // red - only for HTTP\n    }\n\n// Check for other common protocols (show in blue)\n// Common protocols: ftp, sms, spotify, steam, slack, etc.\n    const protoMatch = lowerAction.match(/^(ftp|ftps|sms|spotify|steam|slack|discord|zoom|teams|whatsapp):/);\n    if (protoMatch) {\n        return { type: protoMatch[1], color: '#3b82f6' };\n    }\n\n    return null;\n}\n\n/**\n * Renders a list of items in the command palette\n * @param {HTMLElement} listElement - The list element to render items in\n * @param {Array} items - The items to render\n * @param {number} selectedIdx - The index of the selected item\n * @param {string} locale - The locale for translations\n * @returns {void}\n */\nexport function renderList(listElement, items, selectedIdx = 0, locale = 'en') {\n    // Store the previously selected item index\n    const prevSelectedIdx = listElement.getAttribute('data-selected-idx');\n    \n    // Get the current items count from the list\n    const currentItemsCount = listElement.querySelectorAll('.cmdk-item').length;\n    \n    // If this is just a selection change and the list is already populated with the same number of items\n    // This ensures we do a full redraw when search results change (different number of items)\n    if (listElement.children.length > 0 && items.length > 0 && \n        items.length === currentItemsCount && prevSelectedIdx !== null) {\n        // Update only the selection state\n        const prevSelected = listElement.querySelector(`.cmdk-item[data-idx=\"${prevSelectedIdx}\"]`);\n        const newSelected = listElement.querySelector(`.cmdk-item[data-idx=\"${selectedIdx}\"]`);\n        \n        if (prevSelected) {\n            prevSelected.classList.remove('selected');\n        }\n        \n        if (newSelected) {\n            newSelected.classList.add('selected');\n            // Update the stored selected index\n            listElement.setAttribute('data-selected-idx', selectedIdx);\n            return;\n        }\n    }\n    \n    // If we need to do a full render (first render or items changed)\n    listElement.innerHTML = '';\n    \n    if (items.length === 0) {\n        const noResultsText = getTranslation('noResults', locale);\n        listElement.innerHTML = `<li style=\"padding: 16px; color: #8b8b93;\">${noResultsText}</li>`;\n        return;\n    }\n    \n    // Get the template ID from the list element ID\n    const id = listElement.id.replace('cmdkList-', '');\n    const templateElement = document.getElementById(`cmdkItemTemplate-${id}`);\n    \n    if (!templateElement) {\n        console.error(`Template element not found: cmdkItemTemplate-${id}`);\n        return;\n    }\n    \n    const templateContent = templateElement.innerHTML;\n    \n    // Create a document fragment to improve performance\n    const fragment = document.createDocumentFragment();\n    \n    items.forEach((item, idx) => {\n        // Create a new item from the template\n        let itemHtml = templateContent;\n        \n        // Replace placeholders with actual values\n        itemHtml = itemHtml.replace(/{{idx}}/g, idx);\n        \n        // Get URL type label if applicable\n        const urlLabel = getUrlTypeLabel(item.action);\n        let nameWithLabel = item.name || '';\n        if (urlLabel) {\n            const labelHtml = `<span style=\"display: inline-block; padding: 2px 6px; margin-right: 6px; font-size: 10px; font-weight: bold; color: white; background-color: ${urlLabel.color}; border-radius: 3px; text-transform: uppercase;\">${urlLabel.type}</span>`;\n            nameWithLabel = labelHtml + nameWithLabel;\n        }\n        itemHtml = itemHtml.replace(/{{name}}/g, nameWithLabel);\n        \n        // Handle icon\n        if (item.icon) {\n            // Get the widget ID from the list element ID\n            const widgetId = listElement.id.replace('cmdkList-', '');\n            // Check if HTML icons are allowed for this widget\n            const allowHtmlIcons = window[`cmdkAllowHtmlIcons_${widgetId}`] || false;\n            \n            // Check if the icon is a URL\n            if (typeof item.icon === 'string' && item.icon.match(/^https?:\\/\\//)) {\n                // Replace the icon placeholder with an img tag\n                itemHtml = itemHtml.replace(/{{#icon}}([\\s\\S]*?){{\\/icon}}/g, \n                    `<img src=\"${item.icon}\" class=\"cmdk-icon\" style=\"width: 22px; height: 22px; object-fit: cover;\">`);\n            } else if (allowHtmlIcons) {\n                // If HTML icons are allowed, use the icon content as HTML\n                // Replace the icon placeholder with the HTML content\n                itemHtml = itemHtml.replace(/{{#icon}}([\\s\\S]*?){{\\/icon}}/g, \n                    item.icon);\n            } else {\n                // Replace the icon content (treat as text)\n                itemHtml = itemHtml.replace(/{{icon}}/g, item.icon);\n                // Keep the icon block\n                itemHtml = itemHtml.replace(/{{#icon}}([\\s\\S]*?){{\\/icon}}/g, '$1');\n            }\n        } else {\n            // Remove the icon block\n            itemHtml = itemHtml.replace(/{{#icon}}[\\s\\S]*?{{\\/icon}}/g, '');\n        }\n        \n        // Handle subtitle\n        if (item.subtitle) {\n            itemHtml = itemHtml.replace(/{{subtitle}}/g, item.subtitle);\n            itemHtml = itemHtml.replace(/{{#subtitle}}([\\s\\S]*?){{\\/subtitle}}/g, '$1');\n        } else {\n            itemHtml = itemHtml.replace(/{{#subtitle}}[\\s\\S]*?{{\\/subtitle}}/g, '');\n        }\n        \n        // Create a temporary element to hold the HTML\n        const temp = document.createElement('div');\n        temp.innerHTML = itemHtml;\n        const li = temp.firstElementChild;\n        \n        // Add special classes for loading, error, and search suggestion items\n        if (item._isLoading) {\n            li.classList.add('_loading');\n        }\n        if (item._isError) {\n            li.classList.add('_error');\n        }\n        if (item._isSearchSuggestion) {\n            li.classList.add('_search-suggestion');\n        }\n        \n        // Add selected class if this is the selected item\n        if (idx === selectedIdx) {\n            li.classList.add('selected');\n        }\n        \n        fragment.appendChild(li);\n    });\n    \n    // Append all items at once\n    listElement.appendChild(fragment);\n    \n    // Store the selected index as a data attribute\n    listElement.setAttribute('data-selected-idx', selectedIdx);\n}\n\n/**\n * Scrolls to the selected item in the list\n * @param {HTMLElement} listElement - The list element\n * @returns {void}\n */\nexport function scrollToSelected(listElement) {\n    const selected = listElement.querySelector('.cmdk-item.selected');\n    if (selected) {\n        selected.scrollIntoView({ block: 'nearest' });\n    }\n}\n\n/**\n * Executes the action of an item\n * @param {Object} item - The item to execute\n * @param {boolean} openInNewTab - Whether to open the link in a new tab (Ctrl/Cmd+Enter)\n * @returns {void}\n */\nexport function executeItemAction(item, openInNewTab = false) {\n    if (!item) return;\n\n    if (typeof item.action === 'function') {\n        item.action();\n    } else if (typeof item.action === 'string') {\n        if (/^#/.test(item.action)) {\n            window.location.hash = item.action;\n        } else {\n            // If Ctrl/Cmd was pressed, open in new tab\n            if (openInNewTab) {\n                window.open(item.action, '_blank');\n            } else {\n                window.location.href = item.action;\n            }\n        }\n    }\n}\n\n/**\n * Adds event listeners to the command palette elements\n * @param {Object} elements - The command palette elements\n * @param {Object} callbacks - The callbacks for the events\n * @returns {void}\n */\nexport function setupEventListeners(elements, callbacks) {\n    const { overlay, panel, search, list } = elements;\n    const { onSearch, onKeyDown, onItemClick, onOverlayClick, onPanelBlur, onFocusIn } = callbacks;\n    \n    // Search input events\n    if (search && onSearch) {\n        search.addEventListener('input', onSearch);\n    }\n    \n    if (search && onKeyDown) {\n        search.addEventListener('keydown', onKeyDown);\n    }\n    \n    // List events\n    if (list && onItemClick) {\n        list.addEventListener('click', (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            const item = e.target.closest('.cmdk-item');\n            if (item) {\n                const idx = parseInt(item.getAttribute('data-idx'), 10);\n                onItemClick(idx);\n            }\n        });\n    }\n    \n    // Mouse movement on list items\n    if (list) {\n        list.addEventListener('mousemove', (e) => {\n            const item = e.target.closest('.cmdk-item');\n            if (item) {\n                const idx = parseInt(item.getAttribute('data-idx'), 10);\n                if (callbacks.onItemHover) {\n                    callbacks.onItemHover(idx);\n                }\n            }\n        });\n    }\n    \n    // Overlay click\n    if (overlay && onOverlayClick) {\n        overlay.addEventListener('click', onOverlayClick);\n    }\n    \n    // Panel blur\n    if (panel && onPanelBlur) {\n        panel.addEventListener('blur', onPanelBlur, true);\n    }\n    \n    // Document focus\n    if (onFocusIn) {\n        document.addEventListener('focusin', onFocusIn);\n    }\n    \n    // Global keyboard shortcuts\n    if (callbacks.onGlobalKeyDown) {\n        window.addEventListener('keydown', callbacks.onGlobalKeyDown);\n    }\n}\n","/**\n * Logger class for Command Palette\n * Provides consistent logging with debug mode control\n */\nclass Logger {\n    /**\n     * Constructor\n     * @param {boolean} debug - Whether debug mode is enabled\n     * @param {string} prefix - Prefix for all log messages\n     */\n    constructor(debug = false, prefix = '[CommandPalette]') {\n        this.debug = debug;\n        this.prefix = prefix;\n        \n        // Show initialization message if debug is enabled\n        if (this.debug) {\n            console.log(\n                '%c' + this.prefix + ' Debug mode is ENABLED',\n                'color: red; font-weight: bold;'\n            );\n        }\n    }\n    \n    /**\n     * Log a message to console if debug is enabled\n     * @param {...any} args - Arguments to pass to console.log\n     */\n    log(...args) {\n        if (this.debug) {\n            console.log(this.prefix, ...args);\n        }\n    }\n    \n    /**\n     * Log a warning to console if debug is enabled\n     * @param {...any} args - Arguments to pass to console.warn\n     */\n    warn(...args) {\n        if (this.debug) {\n            console.warn(this.prefix, ...args);\n        }\n    }\n    \n    /**\n     * Log an error to console if debug is enabled\n     * @param {...any} args - Arguments to pass to console.error\n     */\n    error(...args) {\n        if (this.debug) {\n            console.error(this.prefix, ...args);\n        }\n    }\n    \n    /**\n     * Log an info message to console if debug is enabled\n     * @param {...any} args - Arguments to pass to console.info\n     */\n    info(...args) {\n        if (this.debug) {\n            console.info(this.prefix, ...args);\n        }\n    }\n}\n\nexport default Logger;\n","/**\n * External search module for fetching items from external API endpoints\n */\n\nimport Logger from './logger.js';\nimport { levenshtein } from './fuzzy.js';\n\n/**\n * External search handler class\n */\nclass ExternalSearch {\n    /**\n     * Constructor\n     * @param {Object} config - Configuration object\n     * @param {string} config.endpoint - The API endpoint URL\n     * @param {Array<string>} config.types - Available search types\n     * @param {number} config.minChars - Minimum characters to trigger search\n     * @param {number} config.timeout - Debounce timeout in milliseconds\n     * @param {boolean} debug - Whether debug mode is enabled\n     */\n    constructor(config, debug = false) {\n        this.endpoint = config.endpoint;\n        this.types = config.types || [];\n        this.minChars = config.minChars || 3;\n        this.timeout = config.timeout || 300;\n        this.logger = new Logger(debug);\n        \n        // Current search state\n        this.currentRequest = null;\n        this.debounceTimer = null;\n        this.isLoading = false;\n        this.activeType = null;\n        this.lastError = null;\n        \n        this.logger.log('External search initialized with config:', config);\n    }\n    \n    /**\n     * Check if a search query matches any of the configured types\n     * @param {string} query - The search query\n     * @returns {Object|null} Matched type info or null\n     */\n    matchType(query) {\n        if (!this.types || this.types.length === 0) {\n            return null;\n        }\n        \n        const words = query.trim().toLowerCase().split(/\\s+/);\n        \n        for (const word of words) {\n            for (const type of this.types) {\n                const typeLower = type.toLowerCase();\n                \n                // Exact match\n                if (word === typeLower) {\n                    return {\n                        type: type,\n                        matchedWord: word,\n                        distance: 0\n                    };\n                }\n                \n                // Fuzzy match using Levenshtein distance\n                const distance = levenshtein(word, typeLower);\n                const threshold = Math.ceil(typeLower.length * 0.3); // 30% threshold\n                \n                if (distance <= threshold) {\n                    return {\n                        type: type,\n                        matchedWord: word,\n                        distance: distance\n                    };\n                }\n            }\n        }\n        \n        return null;\n    }\n    \n    /**\n     * Extract search terms from query, removing the matched type word\n     * @param {string} query - The full query\n     * @param {string} matchedWord - The word that matched the type\n     * @returns {string} Clean search terms\n     */\n    extractSearchTerms(query, matchedWord) {\n        return query\n            .split(/\\s+/)\n            .filter(word => word.toLowerCase() !== matchedWord.toLowerCase())\n            .join(' ')\n            .trim();\n    }\n    \n    /**\n     * Perform external search\n     * @param {string} query - The search query\n     * @param {string|null} type - Optional type filter\n     * @returns {Promise<Array>} Search results\n     */\n    async search(query, type = null) {\n        // Cancel previous request\n        if (this.currentRequest) {\n            this.currentRequest.abort();\n            this.logger.log('Previous search request cancelled');\n        }\n        \n        // Check minimum character requirement\n        if (query.length < this.minChars) {\n            this.logger.log('Query too short, minimum:', this.minChars);\n            return [];\n        }\n        \n        this.isLoading = true;\n        this.lastError = null;\n        \n        try {\n            // Create AbortController for this request\n            const controller = new AbortController();\n            this.currentRequest = controller;\n            \n            // Build URL with query parameters\n            const url = new URL(this.endpoint, window.location.origin);\n            url.searchParams.append('query', query);\n            if (type) {\n                url.searchParams.append('type', type);\n            }\n            \n            this.logger.log('Fetching external results from:', url.toString());\n            \n            const response = await fetch(url.toString(), {\n                method: 'GET',\n                headers: {\n                    'Accept': 'application/json',\n                },\n                signal: controller.signal\n            });\n            \n            if (!response.ok) {\n                throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n            }\n            \n            const data = await response.json();\n            \n            this.logger.log('External search results:', data.length, 'items');\n            \n            return Array.isArray(data) ? data : [];\n            \n        } catch (error) {\n            if (error.name === 'AbortError') {\n                this.logger.log('Search request aborted');\n                return [];\n            }\n            \n            this.logger.error('External search error:', error);\n            this.lastError = error.message;\n            throw error;\n            \n        } finally {\n            this.isLoading = false;\n            this.currentRequest = null;\n        }\n    }\n    \n    /**\n     * Perform debounced search\n     * @param {string} query - The search query\n     * @param {string|null} type - Optional type filter\n     * @param {Function} callback - Callback function with results\n     */\n    debouncedSearch(query, type, callback) {\n        // Clear existing timer\n        if (this.debounceTimer) {\n            clearTimeout(this.debounceTimer);\n        }\n        \n        // Set new timer\n        this.debounceTimer = setTimeout(async () => {\n            try {\n                const results = await this.search(query, type);\n                callback(results, null);\n            } catch (error) {\n                callback([], error);\n            }\n        }, this.timeout);\n    }\n    \n    /**\n     * Cancel any pending search\n     */\n    cancel() {\n        if (this.debounceTimer) {\n            clearTimeout(this.debounceTimer);\n            this.debounceTimer = null;\n        }\n        \n        if (this.currentRequest) {\n            this.currentRequest.abort();\n            this.currentRequest = null;\n        }\n        \n        this.isLoading = false;\n    }\n}\n\nexport default ExternalSearch;\n","/**\n * Main palette logic for the command palette\n */\n\nimport { filterItems } from './fuzzy.js';\nimport { renderList, scrollToSelected, executeItemAction, setupEventListeners } from './dom.js';\nimport { getTranslation, getTranslations } from './i18n.js';\nimport Logger from './logger.js';\nimport ExternalSearch from './external-search.js';\n\n// Import SCSS for Vite to process\nimport '../scss/palette.scss';\n\n/**\n * Command Palette class\n */\nclass CommandPalette {\n    /**\n     * Constructor\n     * @param {string} id - The ID of the command palette\n     * @param {Array} items - The items to display in the command palette\n     * @param {string} locale - The locale for translations\n     * @param {boolean} debug - Whether debug mode is enabled\n     * @param {Object|null} externalSearchConfig - External search configuration\n     */\n    constructor(id, items = [], locale = 'en', debug = false, externalSearchConfig = null) {\n        this.id = id;\n        this.items = items;\n        this.filtered = [...items];\n        this.selectedIdx = 0;\n        this.isOpen = false;\n        this.locale = locale;\n        this.debug = debug;\n        \n        // Track Ctrl/Cmd key state for new tab shortcuts\n        this.ctrlKeyPressed = false;\n        \n        // External search\n        this.externalSearch = externalSearchConfig ? new ExternalSearch(externalSearchConfig, debug) : null;\n        this.externalResults = [];\n        this.searchMode = null; // null or { type: 'typename', query: 'search terms' }\n        \n        // Initialize logger\n        this.logger = new Logger(debug);\n        \n        this.logger.log('Initializing command palette with', items.length, 'items');\n        if (this.externalSearch) {\n            this.logger.log('External search enabled for types:', externalSearchConfig.types);\n        }\n        \n        // Get DOM elements\n        this.elements = {\n            overlay: document.getElementById(`cmdkOverlay-${id}`),\n            panel: document.getElementById(`cmdkPanel-${id}`),\n            search: document.getElementById(`cmdkSearch-${id}`),\n            list: document.getElementById(`cmdkList-${id}`)\n        };\n        \n        // Set placeholder text based on locale\n        if (this.elements.search) {\n            this.elements.search.placeholder = getTranslation('search', this.locale);\n        }\n        \n        // Initialize\n        this.init();\n    }\n    \n    /**\n     * Initialize the command palette\n     * @returns {void}\n     */\n    init() {\n        // Set up event listeners\n        setupEventListeners(this.elements, {\n            onSearch: this.handleSearch.bind(this),\n            onKeyDown: this.handleKeyDown.bind(this),\n            onItemClick: this.selectItem.bind(this),\n            onItemHover: this.handleItemHover.bind(this),\n            onOverlayClick: this.close.bind(this),\n            onPanelBlur: this.handlePanelBlur.bind(this),\n            onFocusIn: this.handleFocusIn.bind(this),\n            onGlobalKeyDown: this.handleGlobalKeyDown.bind(this)\n        });\n        \n        // Track Ctrl/Cmd key state globally\n        document.addEventListener('keydown', (e) => {\n            if (e.key === 'Control' || e.key === 'Meta') {\n                this.ctrlKeyPressed = true;\n                this.logger.log('Ctrl/Cmd key pressed');\n            }\n        });\n        \n        document.addEventListener('keyup', (e) => {\n            if (e.key === 'Control' || e.key === 'Meta') {\n                this.ctrlKeyPressed = false;\n                this.logger.log('Ctrl/Cmd key released');\n            }\n        });\n        \n        // Initial render\n        renderList(this.elements.list, this.filtered, this.selectedIdx, this.locale);\n    }\n    \n    /**\n     * Open the command palette\n     * @returns {void}\n     */\n    open() {\n        if (this.isOpen) return;\n        \n        this.logger.log('Opening command palette');\n        \n        this.isOpen = true;\n        this.elements.overlay.style.display = 'block';\n        this.elements.panel.style.display = 'flex';\n        \n        setTimeout(() => this.elements.search.focus(), 20);\n        \n        this.elements.search.value = '';\n        this.filtered = [...this.items];\n        this.selectedIdx = 0;\n        \n        renderList(this.elements.list, this.filtered, this.selectedIdx, this.locale);\n    }\n    \n    /**\n     * Close the command palette\n     * @returns {void}\n     */\n    close() {\n        this.logger.log('Closing command palette');\n        this.isOpen = false;\n        this.elements.overlay.style.display = 'none';\n        this.elements.panel.style.display = 'none';\n    }\n    \n    /**\n     * Handle search input\n     * @param {Event} e - The input event\n     * @returns {void}\n     */\n    handleSearch(e) {\n        const query = e.target.value.trim();\n        \n        // If in search mode, perform external search\n        if (this.searchMode) {\n            this.performExternalSearch(query);\n            return;\n        }\n        \n        // Filter local items\n        this.filtered = filterItems(query, this.items);\n        \n        // Check if query matches an external search type\n        if (this.externalSearch && query) {\n            const typeMatch = this.externalSearch.matchType(query);\n            \n            if (typeMatch) {\n                // Extract search terms (removing the type word)\n                const searchTerms = this.externalSearch.extractSearchTerms(query, typeMatch.matchedWord);\n                \n                // Add a suggestion item to trigger search mode\n                const suggestionItem = {\n                    icon: 'üîç',\n                    name: `Search \"${searchTerms || '...'}\" in ${typeMatch.type}`,\n                    subtitle: 'Press Enter to search in this category',\n                    action: null,\n                    _isSearchSuggestion: true,\n                    _searchType: typeMatch.type,\n                    _searchTerms: searchTerms\n                };\n                \n                // Add suggestion at the beginning\n                this.filtered = [suggestionItem, ...this.filtered];\n            }\n        }\n        \n        this.selectedIdx = 0;\n        renderList(this.elements.list, this.filtered, this.selectedIdx, this.locale);\n    }\n    \n    /**\n     * Perform external search\n     * @param {string} query - The search query\n     * @returns {void}\n     */\n    performExternalSearch(query) {\n        // Show loading state\n        this.showLoadingState();\n        \n        // Perform debounced search\n        this.externalSearch.debouncedSearch(query, this.searchMode.type, (results, error) => {\n            if (error) {\n                this.showErrorState(error.message || 'Search failed');\n                this.logger.error('External search error:', error);\n                return;\n            }\n            \n            this.externalResults = results;\n            this.filtered = results;\n            this.selectedIdx = 0;\n            renderList(this.elements.list, this.filtered, this.selectedIdx, this.locale);\n        });\n    }\n    \n    /**\n     * Show loading state with placeholder items\n     * @returns {void}\n     */\n    showLoadingState() {\n        const loadingItems = [\n            { icon: '', name: 'Loading...', subtitle: '', action: null, _isLoading: true },\n            { icon: '', name: 'Loading...', subtitle: '', action: null, _isLoading: true },\n            { icon: '', name: 'Loading...', subtitle: '', action: null, _isLoading: true }\n        ];\n        this.filtered = loadingItems;\n        renderList(this.elements.list, this.filtered, -1, this.locale);\n    }\n    \n    /**\n     * Show error state\n     * @param {string} message - The error message\n     * @returns {void}\n     */\n    showErrorState(message) {\n        const errorItem = {\n            icon: '‚ö†Ô∏è',\n            name: 'Search Error',\n            subtitle: message,\n            action: null,\n            _isError: true\n        };\n        this.filtered = [errorItem];\n        renderList(this.elements.list, this.filtered, -1, this.locale);\n    }\n    \n    /**\n     * Enter search mode for a specific type\n     * @param {string} type - The search type\n     * @param {string} initialQuery - Initial search query\n     * @returns {void}\n     */\n    enterSearchMode(type, initialQuery = '') {\n        this.searchMode = { type, query: initialQuery };\n        this.logger.log('Entering search mode for type:', type);\n        \n        // Update search input\n        this.elements.search.value = initialQuery;\n        \n        // Add visual indicator (tag/badge)\n        this.addSearchModeTag(type);\n        \n        // Perform initial search if there's a query\n        if (initialQuery) {\n            this.performExternalSearch(initialQuery);\n        } else {\n            // Show empty state\n            this.filtered = [];\n            renderList(this.elements.list, this.filtered, this.selectedIdx, this.locale);\n        }\n    }\n    \n    /**\n     * Exit search mode\n     * @returns {void}\n     */\n    exitSearchMode() {\n        this.searchMode = null;\n        this.externalResults = [];\n        \n        // Cancel any pending search\n        if (this.externalSearch) {\n            this.externalSearch.cancel();\n        }\n        \n        // Remove search mode tag\n        this.removeSearchModeTag();\n        \n        // Reset to local items\n        this.filtered = [...this.items];\n        this.selectedIdx = 0;\n        renderList(this.elements.list, this.filtered, this.selectedIdx, this.locale);\n        \n        this.logger.log('Exited search mode');\n    }\n    \n    /**\n     * Add visual tag/badge for search mode\n     * @param {string} type - The search type\n     * @returns {void}\n     */\n    addSearchModeTag(type) {\n        // Remove existing tag if any\n        this.removeSearchModeTag();\n        \n        const tag = document.createElement('div');\n        tag.className = 'cmdk-search-tag';\n        tag.id = `cmdkSearchTag-${this.id}`;\n        tag.innerHTML = `\n            <span class=\"cmdk-search-tag-text\">${type}</span>\n            <button class=\"cmdk-search-tag-close\" type=\"button\">&times;</button>\n        `;\n        \n        // Add click handler for close button\n        tag.querySelector('.cmdk-search-tag-close').addEventListener('click', () => {\n            this.exitSearchMode();\n        });\n        \n        // Insert before search input\n        this.elements.search.parentNode.insertBefore(tag, this.elements.search);\n        \n        // Add padding to search input\n        this.elements.search.classList.add('cmdk-search-with-tag');\n    }\n    \n    /**\n     * Remove search mode tag\n     * @returns {void}\n     */\n    removeSearchModeTag() {\n        const tag = document.getElementById(`cmdkSearchTag-${this.id}`);\n        if (tag) {\n            tag.remove();\n        }\n        this.elements.search.classList.remove('cmdk-search-with-tag');\n    }\n    \n    /**\n     * Handle key down events\n     * @param {KeyboardEvent} e - The keyboard event\n     * @returns {void}\n     */\n    handleKeyDown(e) {\n        // Handle backspace in search mode\n        if (e.key === 'Backspace' && this.searchMode && this.elements.search.value === '') {\n            e.preventDefault();\n            this.exitSearchMode();\n            return;\n        }\n        \n        if (e.key === 'ArrowDown') {\n            e.preventDefault();\n            this.selectedIdx = (this.selectedIdx + 1) % this.filtered.length;\n            renderList(this.elements.list, this.filtered, this.selectedIdx, this.locale);\n            scrollToSelected(this.elements.list);\n        } else if (e.key === 'ArrowUp') {\n            e.preventDefault();\n            this.selectedIdx = (this.selectedIdx - 1 + this.filtered.length) % this.filtered.length;\n            renderList(this.elements.list, this.filtered, this.selectedIdx, this.locale);\n            scrollToSelected(this.elements.list);\n        } else if (e.key === 'Enter') {\n            e.preventDefault();\n            this.selectItem(this.selectedIdx);\n        } else if (e.key === 'Escape') {\n            this.close();\n        }\n    }\n    \n    /**\n     * Handle global key down events\n     * @param {KeyboardEvent} e - The keyboard event\n     * @returns {void}\n     */\n    handleGlobalKeyDown(e) {\n        if ((e.metaKey || e.ctrlKey) && e.key.toLowerCase() === 'k') {\n            e.preventDefault();\n            this.open();\n        }\n        \n        if (this.isOpen && e.key === 'Escape') {\n            this.close();\n        }\n    }\n    \n    /**\n     * Handle panel blur events\n     * @param {FocusEvent} e - The focus event\n     * @returns {void}\n     */\n    handlePanelBlur(e) {\n        // Espera brevemente antes de cerrar, para permitir que el click procese la acci√≥n\n        setTimeout(() => {\n            if (!this.elements.panel.contains(document.activeElement)) {\n                this.close();\n            }\n        }, 10);\n    }\n    \n    /**\n     * Handle focus in events\n     * @param {FocusEvent} e - The focus event\n     * @returns {void}\n     */\n    handleFocusIn(e) {\n        if (this.isOpen && !this.elements.panel.contains(e.target)) {\n            this.close();\n        }\n    }\n    \n    /**\n     * Handle item hover events\n     * @param {number} idx - The index of the hovered item\n     * @returns {void}\n     */\n    handleItemHover(idx) {\n        if (idx !== this.selectedIdx) {\n            this.selectedIdx = idx;\n            renderList(this.elements.list, this.filtered, this.selectedIdx, this.locale);\n        }\n    }\n    \n    /**\n     * Select an item\n     * @param {number} idx - The index of the item to select\n     * @returns {void}\n     */\n    selectItem(idx) {\n        const item = this.filtered[idx];\n        if (!item) return;\n        \n        // Check if this is a search suggestion\n        if (item._isSearchSuggestion) {\n            this.enterSearchMode(item._searchType, item._searchTerms);\n            return;\n        }\n        \n        // Check if this is a loading or error item\n        if (item._isLoading || item._isError) {\n            return;\n        }\n        \n        this.logger.log('Item selected:', item.name, 'Ctrl/Cmd pressed:', this.ctrlKeyPressed);\n        executeItemAction(item, this.ctrlKeyPressed); // Pass Ctrl key state\n        this.close();            // Luego cierra el panel\n    }\n}\n\n// Export the CommandPalette class\nexport default CommandPalette;\n\n// Make it available globally\nwindow.CommandPalette = CommandPalette;\n"],"names":["fuzzyMinLevenshtein","query","text","minDist","i","substr","levenshtein","a","b","m","n","dp","j","cost","filterItems","items","exactMatches","item","name","subtitle","distName","distSubtitle","score","substringMatch","translations","getTranslation","key","locale","getUrlTypeLabel","action","lowerAction","protoMatch","renderList","listElement","selectedIdx","prevSelectedIdx","currentItemsCount","prevSelected","newSelected","noResultsText","id","templateElement","templateContent","fragment","idx","itemHtml","urlLabel","nameWithLabel","widgetId","allowHtmlIcons","temp","li","scrollToSelected","selected","executeItemAction","openInNewTab","setupEventListeners","elements","callbacks","overlay","panel","search","list","onSearch","onKeyDown","onItemClick","onOverlayClick","onPanelBlur","onFocusIn","e","Logger","debug","prefix","args","ExternalSearch","config","words","word","type","typeLower","distance","threshold","matchedWord","controller","url","response","data","error","callback","results","CommandPalette","externalSearchConfig","typeMatch","searchTerms","suggestionItem","loadingItems","message","errorItem","initialQuery","tag"],"mappings":"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"}