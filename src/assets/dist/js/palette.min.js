var CommandPalette=function(){"use strict";function b(i,e){if(!i||!e)return 1/0;let t=1/0;for(let s=0;s<=e.length-i.length;s++){const n=e.substr(s,i.length);t=Math.min(t,y(i,n))}return t=Math.min(t,y(i,e)),t}function y(i,e){const t=i.length,s=e.length;if(t===0)return s;if(s===0)return t;const n=[];for(let r=0;r<=t;r++)n[r]=[r];for(let r=1;r<=s;r++)n[0][r]=r;for(let r=1;r<=t;r++)for(let o=1;o<=s;o++){const h=i[r-1].toLowerCase()===e[o-1].toLowerCase()?0:1;n[r][o]=Math.min(n[r-1][o]+1,n[r][o-1]+1,n[r-1][o-1]+h)}return n[t][s]}function T(i,e){if(!i)return e.slice();i=i.trim().toLowerCase();let t=e.filter(s=>{const n=s.name.toLowerCase(),r=s.subtitle?s.subtitle.toLowerCase():"";return n.includes(i)||r.includes(i)});return t.length>0?t:e.map(s=>{const n=s.name.toLowerCase(),r=s.subtitle?s.subtitle.toLowerCase():"",o=b(i,n),h=r?b(i,r):1/0,g=Math.min(o,h),m=n.includes(i)||r.includes(i);return{...s,_score:g,_substringMatch:m}}).sort((s,n)=>s._substringMatch&&!n._substringMatch?-1:!s._substringMatch&&n._substringMatch?1:s._score-n._score).filter(s=>s._substringMatch||s._score<=2)}const w={en:{search:"Search...",noResults:"No results"},es:{search:"Buscar...",noResults:"Sin resultados"},fr:{search:"Rechercher...",noResults:"Aucun r√©sultat"},de:{search:"Suchen...",noResults:"Keine Ergebnisse"},it:{search:"Cerca...",noResults:"Nessun risultato"},pt:{search:"Pesquisar...",noResults:"Sem resultados"},ru:{search:"–ü–æ–∏—Å–∫...",noResults:"–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"},zh:{search:"ÊêúÁ¥¢...",noResults:"Ê≤°ÊúâÁªìÊûú"},ja:{search:"Ê§úÁ¥¢...",noResults:"ÁµêÊûú„Å™„Åó"},ar:{search:"ÿ®ÿ≠ÿ´...",noResults:"ŸÑÿß ŸÜÿ™ÿßÿ¶ÿ¨"}};function x(i,e="en"){return w[e]||(e="en"),w[e][i]||i}function E(i){if(typeof i!="string")return null;const e=i.toLowerCase();if(e.startsWith("mailto:"))return{type:"email",color:"#f59e0b"};if(e.startsWith("tel:"))return{type:"phone",color:"#10b981"};if(e.startsWith("http://"))return{type:"unsecure",color:"#ef4444"};const t=e.match(/^(ftp|ftps|sms|spotify|steam|slack|discord|zoom|teams|whatsapp):/);return t?{type:t[1],color:"#3b82f6"}:null}function c(i,e,t=0,s="en"){const n=i.getAttribute("data-selected-idx"),r=i.querySelectorAll(".cmdk-item").length;if(i.children.length>0&&e.length>0&&e.length===r&&n!==null){const a=i.querySelector(`.cmdk-item[data-idx="${n}"]`),u=i.querySelector(`.cmdk-item[data-idx="${t}"]`);if(a&&a.classList.remove("selected"),u){u.classList.add("selected"),i.setAttribute("data-selected-idx",t);return}}if(i.innerHTML="",e.length===0){const a=x("noResults",s);i.innerHTML=`<li style="padding: 16px; color: #8b8b93;">${a}</li>`;return}const o=i.id.replace("cmdkList-",""),h=document.getElementById(`cmdkItemTemplate-${o}`);if(!h){console.error(`Template element not found: cmdkItemTemplate-${o}`);return}const g=h.innerHTML,m=document.createDocumentFragment();e.forEach((a,u)=>{let l=g;l=l.replace(/{{idx}}/g,u);const d=E(a.action);let f=a.name||"";if(d&&(f=`<span style="display: inline-block; padding: 2px 6px; margin-right: 6px; font-size: 10px; font-weight: bold; color: white; background-color: ${d.color}; border-radius: 3px; text-transform: uppercase;">${d.type}</span>`+f),l=l.replace(/{{name}}/g,f),a.icon){const k=i.id.replace("cmdkList-",""),R=window[`cmdkAllowHtmlIcons_${k}`]||!1;typeof a.icon=="string"&&a.icon.match(/^https?:\/\//)?l=l.replace(/{{#icon}}([\s\S]*?){{\/icon}}/g,`<img src="${a.icon}" class="cmdk-icon" style="width: 22px; height: 22px; object-fit: cover;">`):R?l=l.replace(/{{#icon}}([\s\S]*?){{\/icon}}/g,a.icon):(l=l.replace(/{{icon}}/g,a.icon),l=l.replace(/{{#icon}}([\s\S]*?){{\/icon}}/g,"$1"))}else l=l.replace(/{{#icon}}[\s\S]*?{{\/icon}}/g,"");a.subtitle?(l=l.replace(/{{subtitle}}/g,a.subtitle),l=l.replace(/{{#subtitle}}([\s\S]*?){{\/subtitle}}/g,"$1")):l=l.replace(/{{#subtitle}}[\s\S]*?{{\/subtitle}}/g,"");const v=document.createElement("div");v.innerHTML=l;const p=v.firstElementChild;a._isLoading&&p.classList.add("_loading"),a._isError&&p.classList.add("_error"),a._isSearchSuggestion&&p.classList.add("_search-suggestion"),u===t&&p.classList.add("selected"),m.appendChild(p)}),i.appendChild(m),i.setAttribute("data-selected-idx",t)}function S(i){const e=i.querySelector(".cmdk-item.selected");e&&e.scrollIntoView({block:"nearest"})}function C(i,e=!1){i&&(typeof i.action=="function"?i.action():typeof i.action=="string"&&(/^#/.test(i.action)?window.location.hash=i.action:e?window.open(i.action,"_blank"):window.location.href=i.action))}function M(i,e){const{overlay:t,panel:s,search:n,list:r}=i,{onSearch:o,onKeyDown:h,onItemClick:g,onOverlayClick:m,onPanelBlur:a,onFocusIn:u}=e;n&&o&&n.addEventListener("input",o),n&&h&&n.addEventListener("keydown",h),r&&g&&r.addEventListener("click",l=>{l.preventDefault(),l.stopPropagation();const d=l.target.closest(".cmdk-item");if(d){const f=parseInt(d.getAttribute("data-idx"),10);g(f)}}),r&&r.addEventListener("mousemove",l=>{const d=l.target.closest(".cmdk-item");if(d){const f=parseInt(d.getAttribute("data-idx"),10);e.onItemHover&&e.onItemHover(f)}}),t&&m&&t.addEventListener("click",m),s&&a&&s.addEventListener("blur",a,!0),u&&document.addEventListener("focusin",u),e.onGlobalKeyDown&&window.addEventListener("keydown",e.onGlobalKeyDown)}class L{constructor(e=!1,t="[CommandPalette]"){this.debug=e,this.prefix=t,this.debug&&console.log("%c"+this.prefix+" Debug mode is ENABLED","color: red; font-weight: bold;")}log(...e){this.debug&&console.log(this.prefix,...e)}warn(...e){this.debug&&console.warn(this.prefix,...e)}error(...e){this.debug&&console.error(this.prefix,...e)}info(...e){this.debug&&console.info(this.prefix,...e)}}class _{constructor(e,t=!1){this.endpoint=e.endpoint,this.types=e.types||[],this.minChars=e.minChars||3,this.timeout=e.timeout||300,this.logger=new L(t),this.currentRequest=null,this.debounceTimer=null,this.isLoading=!1,this.activeType=null,this.lastError=null,this.logger.log("External search initialized with config:",e)}matchType(e){if(!this.types||this.types.length===0)return null;const t=e.trim().toLowerCase().split(/\s+/);for(const s of t)for(const n of this.types){const r=n.toLowerCase();if(s===r)return{type:n,matchedWord:s,distance:0};const o=y(s,r),h=Math.ceil(r.length*.3);if(o<=h)return{type:n,matchedWord:s,distance:o}}return null}extractSearchTerms(e,t){return e.split(/\s+/).filter(s=>s.toLowerCase()!==t.toLowerCase()).join(" ").trim()}async search(e,t=null){if(this.currentRequest&&(this.currentRequest.abort(),this.logger.log("Previous search request cancelled")),e.length<this.minChars)return this.logger.log("Query too short, minimum:",this.minChars),[];this.isLoading=!0,this.lastError=null;try{const s=new AbortController;this.currentRequest=s;const n=new URL(this.endpoint,window.location.origin);n.searchParams.append("query",e),t&&n.searchParams.append("type",t),this.logger.log("Fetching external results from:",n.toString());const r=await fetch(n.toString(),{method:"GET",headers:{Accept:"application/json"},signal:s.signal});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const o=await r.json();return this.logger.log("External search results:",o.length,"items"),Array.isArray(o)?o:[]}catch(s){if(s.name==="AbortError")return this.logger.log("Search request aborted"),[];throw this.logger.error("External search error:",s),this.lastError=s.message,s}finally{this.isLoading=!1,this.currentRequest=null}}debouncedSearch(e,t,s){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(async()=>{try{const n=await this.search(e,t);s(n,null)}catch(n){s([],n)}},this.timeout)}cancel(){this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=null),this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=null),this.isLoading=!1}}class I{constructor(e,t=[],s="en",n=!1,r=null){this.id=e,this.items=t,this.filtered=[...t],this.selectedIdx=0,this.isOpen=!1,this.locale=s,this.debug=n,this.ctrlKeyPressed=!1,this.externalSearch=r?new _(r,n):null,this.externalResults=[],this.searchMode=null,this.logger=new L(n),this.logger.log("Initializing command palette with",t.length,"items"),this.externalSearch&&this.logger.log("External search enabled for types:",r.types),this.elements={overlay:document.getElementById(`cmdkOverlay-${e}`),panel:document.getElementById(`cmdkPanel-${e}`),search:document.getElementById(`cmdkSearch-${e}`),list:document.getElementById(`cmdkList-${e}`)},this.elements.search&&(this.elements.search.placeholder=x("search",this.locale)),this.init()}init(){M(this.elements,{onSearch:this.handleSearch.bind(this),onKeyDown:this.handleKeyDown.bind(this),onItemClick:this.selectItem.bind(this),onItemHover:this.handleItemHover.bind(this),onOverlayClick:this.close.bind(this),onPanelBlur:this.handlePanelBlur.bind(this),onFocusIn:this.handleFocusIn.bind(this),onGlobalKeyDown:this.handleGlobalKeyDown.bind(this)}),document.addEventListener("keydown",e=>{(e.key==="Control"||e.key==="Meta")&&(this.ctrlKeyPressed=!0,this.logger.log("Ctrl/Cmd key pressed"))}),document.addEventListener("keyup",e=>{(e.key==="Control"||e.key==="Meta")&&(this.ctrlKeyPressed=!1,this.logger.log("Ctrl/Cmd key released"))}),c(this.elements.list,this.filtered,this.selectedIdx,this.locale)}open(){this.isOpen||(this.logger.log("Opening command palette"),this.isOpen=!0,this.elements.overlay.style.display="block",this.elements.panel.style.display="flex",setTimeout(()=>this.elements.search.focus(),20),this.elements.search.value="",this.filtered=[...this.items],this.selectedIdx=0,c(this.elements.list,this.filtered,this.selectedIdx,this.locale))}close(){this.logger.log("Closing command palette"),this.isOpen=!1,this.elements.overlay.style.display="none",this.elements.panel.style.display="none"}handleSearch(e){const t=e.target.value.trim();if(this.searchMode){this.performExternalSearch(t);return}if(this.filtered=T(t,this.items),this.externalSearch&&t){const s=this.externalSearch.matchType(t);if(s){const n=this.externalSearch.extractSearchTerms(t,s.matchedWord),r={icon:"üîç",name:`Search "${n||"..."}" in ${s.type}`,subtitle:"Press Enter to search in this category",action:null,_isSearchSuggestion:!0,_searchType:s.type,_searchTerms:n};this.filtered=[r,...this.filtered]}}this.selectedIdx=0,c(this.elements.list,this.filtered,this.selectedIdx,this.locale)}performExternalSearch(e){this.showLoadingState(),this.externalSearch.debouncedSearch(e,this.searchMode.type,(t,s)=>{if(s){this.showErrorState(s.message||"Search failed"),this.logger.error("External search error:",s);return}this.externalResults=t,this.filtered=t,this.selectedIdx=0,c(this.elements.list,this.filtered,this.selectedIdx,this.locale)})}showLoadingState(){const e=[{icon:"",name:"Loading...",subtitle:"",action:null,_isLoading:!0},{icon:"",name:"Loading...",subtitle:"",action:null,_isLoading:!0},{icon:"",name:"Loading...",subtitle:"",action:null,_isLoading:!0}];this.filtered=e,c(this.elements.list,this.filtered,-1,this.locale)}showErrorState(e){const t={icon:"‚ö†Ô∏è",name:"Search Error",subtitle:e,action:null,_isError:!0};this.filtered=[t],c(this.elements.list,this.filtered,-1,this.locale)}enterSearchMode(e,t=""){this.searchMode={type:e,query:t},this.logger.log("Entering search mode for type:",e),this.elements.search.value=t,this.addSearchModeTag(e),t?this.performExternalSearch(t):(this.filtered=[],c(this.elements.list,this.filtered,this.selectedIdx,this.locale))}exitSearchMode(){this.searchMode=null,this.externalResults=[],this.externalSearch&&this.externalSearch.cancel(),this.removeSearchModeTag(),this.filtered=[...this.items],this.selectedIdx=0,c(this.elements.list,this.filtered,this.selectedIdx,this.locale),this.logger.log("Exited search mode")}addSearchModeTag(e){this.removeSearchModeTag();const t=document.createElement("div");t.className="cmdk-search-tag",t.id=`cmdkSearchTag-${this.id}`,t.innerHTML=`
            <span class="cmdk-search-tag-text">${e}</span>
            <button class="cmdk-search-tag-close" type="button">&times;</button>
        `,t.querySelector(".cmdk-search-tag-close").addEventListener("click",()=>{this.exitSearchMode()}),this.elements.search.parentNode.insertBefore(t,this.elements.search),this.elements.search.classList.add("cmdk-search-with-tag")}removeSearchModeTag(){const e=document.getElementById(`cmdkSearchTag-${this.id}`);e&&e.remove(),this.elements.search.classList.remove("cmdk-search-with-tag")}handleKeyDown(e){if(e.key==="Backspace"&&this.searchMode&&this.elements.search.value===""){e.preventDefault(),this.exitSearchMode();return}e.key==="ArrowDown"?(e.preventDefault(),this.selectedIdx=(this.selectedIdx+1)%this.filtered.length,c(this.elements.list,this.filtered,this.selectedIdx,this.locale),S(this.elements.list)):e.key==="ArrowUp"?(e.preventDefault(),this.selectedIdx=(this.selectedIdx-1+this.filtered.length)%this.filtered.length,c(this.elements.list,this.filtered,this.selectedIdx,this.locale),S(this.elements.list)):e.key==="Enter"?(e.preventDefault(),this.selectItem(this.selectedIdx)):e.key==="Escape"&&this.close()}handleGlobalKeyDown(e){(e.metaKey||e.ctrlKey)&&e.key.toLowerCase()==="k"&&(e.preventDefault(),this.open()),this.isOpen&&e.key==="Escape"&&this.close()}handlePanelBlur(e){setTimeout(()=>{this.elements.panel.contains(document.activeElement)||this.close()},10)}handleFocusIn(e){this.isOpen&&!this.elements.panel.contains(e.target)&&this.close()}handleItemHover(e){e!==this.selectedIdx&&(this.selectedIdx=e,c(this.elements.list,this.filtered,this.selectedIdx,this.locale))}selectItem(e){const t=this.filtered[e];if(t){if(t._isSearchSuggestion){this.enterSearchMode(t._searchType,t._searchTerms);return}t._isLoading||t._isError||(this.logger.log("Item selected:",t.name,"Ctrl/Cmd pressed:",this.ctrlKeyPressed),C(t,this.ctrlKeyPressed),this.close())}}}return window.CommandPalette=I,I}();
//# sourceMappingURL=palette.min.js.map
